# Amplify Gen2 環境変数設定手順

このドキュメントでは、Amplify Gen2のコンソールから環境変数を設定する手順を説明します。

## 設定が必要な環境変数

| 環境変数名 | 説明 | 例 |
|-----------|------|-----|
| `VITE_AWS_REGION` | AWSリージョン | `ap-northeast-1` |
| `VITE_AWS_ACCESS_KEY_ID` | AWSアクセスキーID | `AKIA...` |
| `VITE_AWS_SECRET_ACCESS_KEY` | AWSシークレットアクセスキー | `xxxxx...` |
| `VITE_APP_NAME` | アプリ名（任意） | `Speech Recognition App` |
| `VITE_VERSION` | バージョン（任意） | `1.0.0` |

---

## 設定手順

### Step 1: Amplifyコンソールにアクセス

1. [AWS Management Console](https://console.aws.amazon.com/) にログイン
2. サービス検索で「**Amplify**」を検索してクリック
3. 対象のアプリケーションを選択

---

### Step 2: ホスティング設定に移動

1. 左側のナビゲーションメニューから「**ホスティング**」→「**ビルドの設定**」をクリック

```
┌─────────────────────────────────────────┐
│  Amplify Console                        │
├─────────────────────────────────────────┤
│  📁 概要                                 │
│  📁 ホスティング                          │
│     ├─ ブランチ                          │
│     ...                                 │
│     └─ 環境変数   ← ここをクリック          │
└─────────────────────────────────────────┘
```

---

### Step 3: 環境変数の設定

「**環境変数を管理**」ボタンをクリック

---

### Step 4: 環境変数を追加

「**新規追加**」ボタンをクリックして、以下の環境変数を1つずつ追加し、「**保存**」ボタンをクリック

| 変数 | 値 |
|------|-----|
| `VITE_AWS_REGION` | `ap-northeast-1` |
| `VITE_AWS_ACCESS_KEY_ID` | （IAMで取得したアクセスキーID） |
| `VITE_AWS_SECRET_ACCESS_KEY` | （IAMで取得したシークレットアクセスキー） |
| `VITE_APP_NAME` | `Speech Recognition` |
| `VITE_VERSION` | `1.0.0` |

---

### Step 5: 再デプロイ

1. 左側のナビゲーションメニューから「**概要**」→「**<接続したブランチ名>**」をクリック
2. 「**このバージョンを再デプロイ**」をクリック


---

### Step 6: 確認

ステータスが「**デプロイ済み**」になれば完了


---

## 注意事項

### セキュリティ上の注意

> ⚠️ **重要**
>
> `VITE_AWS_ACCESS_KEY_ID`と`VITE_AWS_SECRET_ACCESS_KEY`はフロントエンドのビルドに含まれるため、**最小権限のIAMユーザー**を使用してください。
>
> 本番環境では、可能であればCognito経由での認証に切り替えることを推奨します。

### ローカル開発時

ローカル開発時は、プロジェクトルートに`.env`ファイルを作成して環境変数を設定します。

```bash
# .env-sample を .env にコピー
cp .env-sample .env

# .env ファイルを編集して値を設定
```
